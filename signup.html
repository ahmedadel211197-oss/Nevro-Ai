<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nevro AI — إنشاء حساب</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&family=Syne:wght@700;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
:root {
  --bg:#07091a; --bg2:#0c1124;
  --surface:rgba(255,255,255,0.04); --border:rgba(255,255,255,0.08); --bh:rgba(99,179,237,0.35);
  --cyan:#63b3ed; --cgl:rgba(99,179,237,0.15);
  --purple:#9f7aea; --pink:#f687b3; --pgl:rgba(246,135,179,0.12);
  --err:#fc8181; --ok:#68d391;
  --text:#eef2ff; --text2:rgba(238,242,255,0.55); --text3:rgba(238,242,255,0.30);
}
[data-theme="light"] {
  --bg:#f6f8fc; --bg2:#edf1f9;
  --surface:rgba(0,0,0,0.03); --border:rgba(0,0,0,0.08); --bh:rgba(37,99,235,0.3);
  --cyan:#2563eb; --cgl:rgba(37,99,235,0.1); --purple:#6d28d9; --pink:#9d174d; --pgl:rgba(157,23,77,0.08);
  --text:#111827; --text2:rgba(17,24,39,0.6); --text3:rgba(17,24,39,0.35);
}
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
body{
  font-family:'Tajawal',sans-serif;
  background:var(--bg);color:var(--text);
  min-height:100vh;overflow-x:hidden;
  display:grid;grid-template-columns:1fr 1fr;
  transition:background .3s,color .3s;
}
#bgCanvas{position:fixed;inset:0;z-index:0;pointer-events:none;opacity:.4;}
[data-theme="light"] #bgCanvas{opacity:.12;}

/* LEFT */
.left-panel{position:relative;z-index:1;display:flex;flex-direction:column;justify-content:space-between;padding:40px 52px;background:linear-gradient(160deg,rgba(99,179,237,0.06),rgba(159,122,234,0.06));border-left:1px solid var(--border);overflow:hidden;}
.left-panel::before{content:'';position:absolute;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,var(--cgl) 0%,transparent 65%);top:-100px;right:-100px;pointer-events:none;}
.left-panel::after{content:'';position:absolute;width:400px;height:400px;border-radius:50%;background:radial-gradient(circle,var(--pgl) 0%,transparent 65%);bottom:-80px;left:-80px;pointer-events:none;}
.brand{display:flex;align-items:center;gap:11px;text-decoration:none;position:relative;z-index:1;}
.brand-logo{width:38px;height:38px;border-radius:11px;overflow:hidden;box-shadow:0 0 18px var(--cgl);flex-shrink:0;}
.brand-logo img{width:100%;height:100%;object-fit:cover;}
.brand-name{font-family:'Syne',sans-serif;font-size:19px;font-weight:800;background:linear-gradient(100deg,var(--cyan) 30%,var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.lp-mid{position:relative;z-index:1;display:flex;flex-direction:column;gap:24px;}
.lp-title{font-family:'Syne',sans-serif;font-size:clamp(24px,3vw,38px);font-weight:800;line-height:1.15;letter-spacing:-.5px;}
.lp-title .gt{background:linear-gradient(100deg,var(--cyan),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.lp-sub{font-size:15px;color:var(--text2);line-height:1.75;max-width:360px;margin-top:8px;}

/* free badge */
.free-badge{display:inline-flex;align-items:center;gap:8px;padding:10px 16px;background:linear-gradient(135deg,rgba(99,179,237,0.1),rgba(159,122,234,0.1));border:1px solid var(--bh);border-radius:14px;}
.free-badge-icon{width:32px;height:32px;border-radius:9px;background:linear-gradient(135deg,var(--cyan),var(--purple));display:flex;align-items:center;justify-content:center;}
.free-badge-icon svg{width:16px;height:16px;color:#fff;}
.free-badge-text{font-size:13px;font-weight:700;}
.free-badge-sub{font-size:11px;color:var(--text2);margin-top:1px;}

.features-list{display:flex;flex-direction:column;gap:10px;}
.feat-row{display:flex;align-items:center;gap:10px;padding:11px 15px;background:var(--surface);border:1px solid var(--border);border-radius:11px;transition:border-color .25s;font-size:13px;}
.feat-row:hover{border-color:var(--bh);}
.ck{color:var(--ok);font-weight:700;flex-shrink:0;}
.lp-bottom{position:relative;z-index:1;font-size:12px;color:var(--text3);}

/* RIGHT */
.right-panel{position:relative;z-index:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 60px;background:var(--bg2);overflow-y:auto;}
.rp-nav{position:absolute;top:0;left:0;right:0;display:flex;align-items:center;justify-content:space-between;padding:20px 32px;}
.rp-back{display:flex;align-items:center;gap:6px;font-size:13px;color:var(--text2);cursor:pointer;background:none;border:none;font-family:'Tajawal',sans-serif;transition:color .2s;}
.rp-back:hover{color:var(--cyan);}
.btn-theme{width:34px;height:34px;border-radius:50%;border:1px solid var(--border);background:var(--surface);color:var(--text2);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;}
.btn-theme:hover{border-color:var(--cyan);color:var(--cyan);}

.form-card{width:100%;max-width:400px;opacity:0;animation:fadeUp .5s .1s forwards;}
.form-title{font-family:'Syne',sans-serif;font-size:26px;font-weight:800;margin-bottom:6px;}
.form-sub{font-size:14px;color:var(--text2);margin-bottom:24px;line-height:1.6;}

.social-btn{width:100%;padding:12px 18px;border-radius:12px;border:1px solid var(--border);background:var(--surface);color:var(--text);font-size:14px;font-family:'Tajawal',sans-serif;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;transition:all .25s;margin-bottom:18px;}
.social-btn:hover{border-color:var(--bh);background:rgba(99,179,237,0.05);}
.social-btn svg{width:18px;height:18px;flex-shrink:0;}

.or-div{display:flex;align-items:center;gap:12px;margin-bottom:18px;font-size:12px;color:var(--text3);}
.or-div::before,.or-div::after{content:'';flex:1;height:1px;background:var(--border);}

.alert{display:none;padding:12px 16px;border-radius:11px;font-size:13px;margin-bottom:16px;border:1px solid;}
.alert.show{display:flex;align-items:center;gap:10px;}
.alert.alert-err{background:rgba(252,129,129,0.1);border-color:rgba(252,129,129,0.3);color:var(--err);}
.alert.alert-ok{background:rgba(104,211,145,0.1);border-color:rgba(104,211,145,0.3);color:var(--ok);}
.alert svg{width:16px;height:16px;flex-shrink:0;}

.fg{margin-bottom:14px;}
.fg label{display:block;font-size:13px;font-weight:600;color:var(--text2);margin-bottom:6px;}
.fg-row{display:flex;gap:10px;}
.fg-row .fg{flex:1;margin-bottom:0;}
.inp-wrap{position:relative;}
.inp{width:100%;padding:11px 42px 11px 14px;background:var(--surface);border:1px solid var(--border);border-radius:11px;color:var(--text);font-family:'Tajawal',sans-serif;font-size:14px;outline:none;transition:all .25s;direction:rtl;}
.inp:focus{border-color:var(--bh);box-shadow:0 0 0 3px var(--cgl);}
.inp.err-inp{border-color:var(--err);box-shadow:0 0 0 3px rgba(252,129,129,0.12);}
.inp.ok-inp{border-color:var(--ok);}
.inp::placeholder{color:var(--text3);}
.inp-with-toggle{padding-left:42px;}
.inp-icon{position:absolute;top:50%;right:13px;transform:translateY(-50%);color:var(--text3);pointer-events:none;}
.inp-icon svg{width:15px;height:15px;}
.inp-toggle{position:absolute;top:50%;left:13px;transform:translateY(-50%);background:none;border:none;color:var(--text3);cursor:pointer;display:flex;align-items:center;transition:color .2s;}
.inp-toggle:hover{color:var(--cyan);}
.inp-toggle svg{width:15px;height:15px;}

/* strength */
.strength-wrap{margin-top:7px;}
.strength-bar{height:3px;border-radius:2px;background:var(--border);overflow:hidden;}
.strength-fill{height:100%;border-radius:2px;width:0;transition:width .35s,background .35s;}
.strength-txt{font-size:11px;color:var(--text3);margin-top:4px;}

/* checkbox */
.check-row{display:flex;align-items:flex-start;gap:10px;margin-bottom:16px;cursor:pointer;}
.check-box{width:18px;height:18px;border-radius:5px;border:1.5px solid var(--border);background:var(--surface);flex-shrink:0;margin-top:1px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;}
.check-box.checked{background:var(--cyan);border-color:var(--cyan);}
.check-box svg{width:11px;height:11px;color:#fff;opacity:0;transition:opacity .2s;}
.check-box.checked svg{opacity:1;}
.check-label{font-size:13px;color:var(--text2);line-height:1.5;}
.check-label a{color:var(--cyan);text-decoration:none;}

.submit-btn{width:100%;padding:13px;border-radius:12px;background:linear-gradient(135deg,var(--cyan),var(--purple));border:none;color:#fff;font-size:15px;font-weight:700;font-family:'Tajawal',sans-serif;cursor:pointer;box-shadow:0 6px 22px var(--cgl);transition:all .3s;display:flex;align-items:center;justify-content:center;gap:9px;}
.submit-btn:hover{transform:translateY(-2px);box-shadow:0 10px 28px var(--cgl);}
.submit-btn:disabled{opacity:.7;cursor:not-allowed;transform:none;}

.spinner{width:16px;height:16px;border-radius:50%;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;animation:spin .7s linear infinite;display:none;}
@keyframes spin{to{transform:rotate(360deg)}}

.switch-link{text-align:center;font-size:13px;color:var(--text2);margin-top:18px;}
.switch-link a{color:var(--cyan);text-decoration:none;font-weight:700;}

/* email sent screen */
.email-sent{display:none;flex-direction:column;align-items:center;text-align:center;gap:16px;width:100%;max-width:400px;}
.email-sent.show{display:flex;animation:fadeUp .5s forwards;}
.sent-title{font-family:'Syne',sans-serif;font-size:22px;font-weight:800;}
.sent-sub{font-size:14px;color:var(--text2);line-height:1.75;max-width:320px;}
.sent-email{font-weight:700;color:var(--cyan);display:block;margin-top:4px;}
.resend-btn{background:none;border:none;color:var(--cyan);font-family:'Tajawal',sans-serif;font-size:13px;cursor:pointer;}
.resend-btn:hover{text-decoration:underline;}

.page-loading{position:fixed;inset:0;background:var(--bg);z-index:999;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:14px;}
.page-loading .sp{width:32px;height:32px;border-radius:50%;border:3px solid var(--border);border-top-color:var(--cyan);animation:spin .8s linear infinite;}
.page-loading p{font-size:14px;color:var(--text2);}

@keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@media(max-width:900px){
  body{grid-template-columns:1fr;}
  .left-panel{display:none;}
  .right-panel{min-height:100vh;padding:100px 24px 40px;}
  .mob-header{display:flex;}
}
.mob-header{
  display:none;
  position:absolute;top:0;left:0;right:0;
  align-items:center;justify-content:center;
  padding:20px 24px;
  border-bottom:1px solid var(--border);
  gap:10px;
}
.mob-logo{width:32px;height:32px;border-radius:9px;overflow:hidden;box-shadow:0 0 12px var(--cgl);flex-shrink:0;}
.mob-logo img{width:100%;height:100%;object-fit:cover;}
.mob-name{font-family:'Syne',sans-serif;font-size:17px;font-weight:800;background:linear-gradient(100deg,var(--cyan) 30%,var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
</style>
</head>
<body>
<canvas id="bgCanvas"></canvas>

<div class="page-loading" id="pageLoading">
  <div class="sp"></div>
  <p>جاري التحقق من الجلسة...</p>
</div>

<!-- LEFT -->
<div class="left-panel">
  <a class="brand" href="index.html">
    <div class="brand-logo">
      <img src="img/logo.png" alt="Nevro AI" onerror="this.style.display='none';this.parentElement.style.background='linear-gradient(135deg,#63b3ed,#9f7aea)';this.parentElement.innerHTML+='<svg viewBox=\'0 0 38 38\' fill=\'none\' style=\'width:22px;height:22px\'><path d=\'M12 26L19 11l7 15\' stroke=\'white\' stroke-width=\'2.5\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/></svg>'">
    </div>
    <span class="brand-name">Nevro AI</span>
  </a>

  <div class="lp-mid">
    <div>
      <h2 class="lp-title">انضم إلى<br><span class="gt">Nevro AI</span> مجاناً</h2>
      <p class="lp-sub">أنشئ حسابك في ثوانٍ وابدأ باستخدام مساعدك الذكي فوراً.</p>
    </div>

    <div class="free-badge">
      <div class="free-badge-icon">
        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
      </div>
      <div>
        <div class="free-badge-text">النسخة المجانية — للأبد</div>
        <div class="free-badge-sub">لا بطاقة ائتمان مطلوبة</div>
      </div>
    </div>

    <div class="features-list">
      <div class="feat-row"><span class="ck">✓</span> وضع المحادثة العامة والأكواد</div>
      <div class="feat-row"><span class="ck">✓</span> الأوضاع المتقدمة بحد يومي</div>
      <div class="feat-row"><span class="ck">✓</span> دعم أكثر من 50 لغة</div>
      <div class="feat-row"><span class="ck">✓</span> تاريخ المحادثات محفوظ</div>
      <div class="feat-row"><span class="ck">✓</span> خصوصية وأمان تام</div>
    </div>
  </div>

  <div class="lp-bottom">© 2026 Nevro AI — جميع الحقوق محفوظة</div>
</div>

<!-- RIGHT -->
<div class="right-panel">
  <!-- Mobile header -->
  <div class="mob-header">
    <div class="mob-logo">
      <img src="img/logo.png" alt="Nevro AI" onerror="this.parentElement.innerHTML='<svg viewBox=\'0 0 32 32\' fill=\'none\'><rect width=\'32\' height=\'32\' rx=\'9\' fill=\'url(#gm2)\'/><defs><linearGradient id=\'gm2\' x1=\'0\' y1=\'0\' x2=\'32\' y2=\'32\'><stop stop-color=\'#63b3ed\'/><stop offset=\'1\' stop-color=\'#9f7aea\'/></linearGradient></defs><path d=\'M10 22L16 10l6 12\' stroke=\'white\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'/></svg>'">
    </div>
    <span class="mob-name">Nevro AI</span>
  </div>

  <div class="rp-nav">
    <button class="rp-back" onclick="location.href='index.html'">
      <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18"/></svg>
      الرئيسية
    </button>
    <button class="btn-theme" id="themeBtn" onclick="toggleTheme()">
      <svg width="15" height="15" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12.79A9 9 0 1111.21 3a7 7 0 009.79 9.79z"/></svg>
    </button>
  </div>

  <!-- FORM -->
  <div class="form-card" id="formCard">
    <div class="form-title" style="display:flex;align-items:center;gap:10px;">
      إنشاء حساب جديد
      <span style="width:28px;height:28px;border-radius:8px;background:linear-gradient(135deg,var(--cyan),var(--purple));display:inline-flex;align-items:center;justify-content:center;flex-shrink:0;">
        <svg width="14" height="14" fill="none" viewBox="0 0 24 24" stroke="white" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
      </span>
    </div>
    <div class="form-sub">انضم مجاناً واستمتع بجميع المميزات الأساسية</div>

    <div class="alert" id="alertBox">
      <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
      <span id="alertMsg"></span>
    </div>

    <!-- Google -->
    <button class="social-btn" onclick="signupGoogle()">
      <svg viewBox="0 0 24 24" fill="none">
        <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
        <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
        <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
        <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
      </svg>
      التسجيل بـ Google
    </button>

    <div class="or-div">أو بالبريد الإلكتروني</div>

    <!-- Name row -->
    <div class="fg">
      <div class="fg-row">
        <div class="fg">
          <label>الاسم الأول</label>
          <div class="inp-wrap">
            <input type="text" class="inp" id="firstName" placeholder="أحمد" oninput="validateField(this,2)">
            <span class="inp-icon"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg></span>
          </div>
        </div>
        <div class="fg">
          <label>الاسم الأخير</label>
          <div class="inp-wrap">
            <input type="text" class="inp" id="lastName" placeholder="محمد" oninput="validateField(this,2)">
            <span class="inp-icon"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg></span>
          </div>
        </div>
      </div>
    </div>

    <!-- Email -->
    <div class="fg">
      <label>البريد الإلكتروني</label>
      <div class="inp-wrap">
        <input type="email" class="inp" id="email" placeholder="example@email.com" oninput="validateEmail(this)" autocomplete="email">
        <span class="inp-icon"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg></span>
      </div>
    </div>

    <!-- Password -->
    <div class="fg">
      <label>كلمة المرور</label>
      <div class="inp-wrap">
        <input type="password" class="inp inp-with-toggle" id="password" placeholder="8 أحرف على الأقل" oninput="checkStrength(this.value)" autocomplete="new-password">
        <span class="inp-icon"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg></span>
        <button class="inp-toggle" onclick="togglePass('password','eye1')" type="button" id="eye1">
          <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
        </button>
      </div>
      <div class="strength-wrap">
        <div class="strength-bar"><div class="strength-fill" id="sf"></div></div>
        <div class="strength-txt" id="st"></div>
      </div>
    </div>

    <!-- Confirm password -->
    <div class="fg">
      <label>تأكيد كلمة المرور</label>
      <div class="inp-wrap">
        <input type="password" class="inp inp-with-toggle" id="confirm" placeholder="أعد كتابة كلمة المرور" oninput="checkMatch()" autocomplete="new-password">
        <span class="inp-icon"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg></span>
        <button class="inp-toggle" onclick="togglePass('confirm','eye2')" type="button" id="eye2">
          <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
        </button>
      </div>
    </div>

    <!-- Terms -->
    <div class="check-row" onclick="toggleCheck()">
      <div class="check-box" id="termsBox">
        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
      </div>
      <div class="check-label">
        أوافق على <a href="terms.html" onclick="event.stopPropagation()">شروط الاستخدام</a>
        و<a href="privacy.html" onclick="event.stopPropagation()">سياسة الخصوصية</a>
      </div>
    </div>

    <button class="submit-btn" id="signupBtn" onclick="handleSignup()">
      <span id="btnText">إنشاء الحساب مجاناً</span>
      <div class="spinner" id="spinner"></div>
    </button>

    <div class="switch-link">
      لديك حساب بالفعل؟ <a href="login.html">تسجيل الدخول</a>
    </div>
  </div>

  <!-- EMAIL SENT -->
  <div class="email-sent" id="emailSent">
    <!-- success checkmark -->
    <div style="width:72px;height:72px;border-radius:50%;background:linear-gradient(135deg,var(--cyan),var(--purple));display:flex;align-items:center;justify-content:center;box-shadow:0 0 30px var(--cgl);">
      <svg width="34" height="34" fill="none" viewBox="0 0 24 24" stroke="white" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg>
    </div>
    <div class="sent-title">تم إنشاء حسابك بنجاح!</div>
    <div class="sent-sub">
      أرسلنا رابط تأكيد إلى<br>
      <span class="sent-email" id="sentEmailDisplay"></span><br><br>
      افتح بريدك الإلكتروني واضغط على الرابط لتفعيل حسابك، ثم ارجع وسجّل دخولك.
    </div>
    <!-- email icon strip -->
    <div style="display:flex;align-items:center;gap:8px;padding:10px 18px;background:var(--surface);border:1px solid var(--border);border-radius:12px;font-size:13px;color:var(--text2);">
      <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8" style="color:var(--cyan);flex-shrink:0"><path stroke-linecap="round" stroke-linejoin="round" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
      تحقق من مجلد البريد العشوائي إذا لم يصل
    </div>
    <div style="display:flex;flex-direction:column;align-items:center;gap:8px;margin-top:4px;">
      <button class="resend-btn" onclick="resendEmail()">لم يصل البريد؟ إعادة الإرسال</button>
      <a href="login.html" style="font-size:13px;color:var(--text3);text-decoration:none;">العودة لتسجيل الدخول</a>
    </div>
  </div>
</div>

<script>
const SUPABASE_URL = 'https://nhykoxjgtilnqgnmehkm.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5oeWtveGpndGlsbnFnbm1laGttIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE3MDIwMDMsImV4cCI6MjA4NzI3ODAwM30.DCV36AHiWKYIeB62ZjG-zdz_k7FtyaYVkyQXpE3SP-s';
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

/* Check session */
(async () => {
  const { data: { session } } = await sb.auth.getSession();
  if (session) { location.href = 'dashboard.html'; return; }
  document.getElementById('pageLoading').style.display = 'none';
})();

let userEmail = '';

/* Signup */
async function handleSignup() {
  const fn    = document.getElementById('firstName').value.trim();
  const ln    = document.getElementById('lastName').value.trim();
  const email = document.getElementById('email').value.trim();
  const pass  = document.getElementById('password').value;
  const conf  = document.getElementById('confirm').value;
  const terms = document.getElementById('termsBox').classList.contains('checked');

  if (!fn || !ln)        { showAlert('يرجى إدخال الاسم الأول والأخير', 'err'); return; }
  if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { showAlert('بريد إلكتروني غير صحيح', 'err'); return; }
  if (pass.length < 8)   { showAlert('كلمة المرور يجب أن تكون 8 أحرف على الأقل', 'err'); return; }
  if (pass !== conf)     { showAlert('كلمات المرور غير متطابقة', 'err'); return; }
  if (!terms)            { showAlert('يرجى الموافقة على شروط الاستخدام', 'err'); return; }

  setLoading(true);
  const { error } = await sb.auth.signUp({
    email,
    password: pass,
    options: {
      data: { first_name: fn, last_name: ln, full_name: fn + ' ' + ln },
      emailRedirectTo: window.location.origin + '/dashboard.html'
    }
  });
  setLoading(false);

  if (error) {
    const msgs = {
      'User already registered': 'هذا البريد الإلكتروني مسجل مسبقاً',
      'Password should be at least 6 characters': 'كلمة المرور قصيرة جداً',
    };
    showAlert(msgs[error.message] || 'حدث خطأ، يرجى المحاولة مجدداً', 'err');
  } else {
    userEmail = email;
    document.getElementById('formCard').style.display   = 'none';
    document.getElementById('sentEmailDisplay').textContent = email;
    document.getElementById('emailSent').classList.add('show');
  }
}

/* Google */
async function signupGoogle() {
  await sb.auth.signInWithOAuth({
    provider: 'google',
    options: { redirectTo: window.location.origin + '/dashboard.html' }
  });
}

/* Resend */
async function resendEmail() {
  if (!userEmail) return;
  await sb.auth.resend({ type: 'signup', email: userEmail });
  alert('تم إعادة إرسال بريد التأكيد!');
}

/* Validators */
function validateField(inp, min) {
  inp.className = 'inp' + (inp.value.length >= min ? ' ok-inp' : inp.value ? ' err-inp' : '');
}
function validateEmail(inp) {
  const ok = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(inp.value);
  inp.className = 'inp' + (inp.value ? (ok ? ' ok-inp' : ' err-inp') : '');
}
function checkStrength(v) {
  const sf = document.getElementById('sf'), st = document.getElementById('st');
  let s = 0;
  if(v.length >= 8) s++; if(/[A-Z]/.test(v)) s++; if(/[0-9]/.test(v)) s++; if(/[^A-Za-z0-9]/.test(v)) s++;
  const L = [{w:'25%',b:'#fc8181',t:'ضعيفة'},{w:'50%',b:'#f6ad55',t:'متوسطة'},{w:'75%',b:'#68d391',t:'جيدة'},{w:'100%',b:'#38a169',t:'قوية جداً'}];
  const l = L[Math.max(0,s-1)];
  sf.style.width = v ? l.w : '0'; sf.style.background = l.b;
  st.textContent = v ? 'قوة كلمة المرور: ' + l.t : ''; st.style.color = l.b;
}
function checkMatch() {
  const p1 = document.getElementById('password').value;
  const p2 = document.getElementById('confirm');
  p2.className = 'inp inp-with-toggle' + (p2.value ? (p1===p2.value ? ' ok-inp' : ' err-inp') : '');
}
function toggleCheck() {
  document.getElementById('termsBox').classList.toggle('checked');
}
function togglePass(id, btnId) {
  const inp = document.getElementById(id), isP = inp.type==='password';
  inp.type = isP ? 'text' : 'password';
  document.getElementById(btnId).innerHTML = isP
    ? `<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"/></svg>`
    : `<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>`;
}
function setLoading(on) {
  document.getElementById('signupBtn').disabled = on;
  document.getElementById('spinner').style.display = on ? 'block' : 'none';
  document.getElementById('btnText').style.opacity = on ? '0' : '1';
}
function showAlert(msg, type) {
  const box = document.getElementById('alertBox');
  box.className = `alert alert-${type} show`;
  document.getElementById('alertMsg').textContent = msg;
}
function toggleTheme() {
  const light = document.body.getAttribute('data-theme') !== 'light';
  document.body.setAttribute('data-theme', light ? 'light' : '');
  document.getElementById('themeBtn').innerHTML = light
    ? `<svg width="15" height="15" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>`
    : `<svg width="15" height="15" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12.79A9 9 0 1111.21 3a7 7 0 009.79 9.79z"/></svg>`;
}
(function(){
  const cv=document.getElementById('bgCanvas'),cx=cv.getContext('2d');let W,H;
  function r(){W=cv.width=innerWidth;H=cv.height=innerHeight;}r();window.addEventListener('resize',r);
  const C=['#63b3ed','#9f7aea','#f687b3'];
  const P=Array.from({length:40},()=>({x:Math.random()*innerWidth,y:Math.random()*innerHeight,vx:(Math.random()-.5)*.18,vy:(Math.random()-.5)*.18,r:Math.random()*1.2+.3,c:C[~~(Math.random()*3)],a:Math.random()*.4+.08}));
  (function d(){cx.clearRect(0,0,W,H);P.forEach(p=>{p.x+=p.vx;p.y+=p.vy;if(p.x<0)p.x=W;if(p.x>W)p.x=0;if(p.y<0)p.y=H;if(p.y>H)p.y=0;cx.beginPath();cx.arc(p.x,p.y,p.r,0,Math.PI*2);cx.fillStyle=p.c;cx.globalAlpha=p.a;cx.fill();});for(let i=0;i<P.length;i++)for(let j=i+1;j<P.length;j++){const d=Math.hypot(P[i].x-P[j].x,P[i].y-P[j].y);if(d<120){cx.beginPath();cx.moveTo(P[i].x,P[i].y);cx.lineTo(P[j].x,P[j].y);cx.strokeStyle=P[i].c;cx.globalAlpha=(1-d/120)*.06;cx.lineWidth=.5;cx.stroke();}}requestAnimationFrame(d);})();
})();
</script>
</body>
</html>
